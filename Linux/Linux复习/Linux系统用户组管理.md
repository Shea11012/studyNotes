#### 用户文件/etc/passwd

```
shea:x:1000:1000:shea,,,:/home/shea:/bin/bash
  1  2   3    4    5         6         7
```

1. 账号名称
2. 密码，早期 UNIX 系统的密码就是放在这个字段上的，但是因为这个文件的特性是所有程序都能读取，很容易造成密码泄露，后来就将这个字段的密码数据改放到 `/etc/shadow` 中，所以会显示一个 “X”
3. UID，0：系统管理员，1~499：系统账号，500-65535：可登录账号
4. GID
5. 用户信息说明列，可用 finger 查看
6. 主文件夹
7. shell

#### 组文件/etc/group

```
www-data:x:33:shea
	1	2  3   4 
```

1. 用户组名称
2. 用户组密码
3. GID ，对应的是  `/etc/passwd` 的第四个字段使用的 GID
4. 该组下的 user 列表，这些 user 成员以该组做为辅助组，多个成员逗号隔开

#### 用户密码/etc/shadow

```
shea: :17674:0:99999:7: : :
  1  2    3  4    5  6 7 8  9
```

1. 用户名
2. 加密后的密码
   - 该列为 `::` ，表示该用户没有密码
   - 该列为 `:!:`  或 `:!!:`，表示该用户被锁，被锁将无法登录，但是其他登录方式不受限制，如 ssh key ，su
   - 该列为 `:*:` ，也表示该用户被锁，等同于 `:!:`
   - 该列列为 `$id$salt$hashed` ，则表示该用户密码正常，其中 `$id$` 的 id 表示密码的加密算法，`$1$` MD5算法，`$2a$` Blowfish 算法，`$2y$` 另一算法长度的 Blowfish，`$5$` SHA-256算法，`$6$` SHA-512算法，`$salt` 加密时使用的 salt ， `$hashed` 真正的密码部分
3. 从 1970 年 1 月 1 日到上次密码修改经过的时间（天数）。通过计算现在离 1970 年 1 月 1日的天数减去这个值，结果就是上次修改密码到现在已经过了多少天，即现在的密码已经使用了多少天
4. 密码最少使用期限（天数），省略或者 0 表示不设置期限
5. 密码最大使用期限（天数），超过了他不一定密码就失效，可能下一个字段设置了过期后的宽限天数，设置为空将永不过期，如果值设置小于最短使用期限，用户将不能修改密码。
6. 密码过期前多少天就开始提醒用户密码将要过期。空或 0 将不提醒
7. 密码过期后宽限的天数，在宽限时间内用户无法使用原密码登录，必须改密码或者联系管理员，设置为空表示没有强制的宽限时间，可以过期后的任意时间内修改密码
8. 账号过期时间，从 1970 年 1 月 1 日开始计算天数，设置为空账号将永不过期，不能设置为 0。不同于密码过期，账号过期后账号失效，修改密码重设密码都无法使用该账号
9. 保留字段

#### 用户的骨架目录/etc/skel

骨架目录是每次新建用户时，都会复制到新用户家目录的文件，默认只有3个环境配置文件，可以修改里面的内容，或者添加文件在骨架目录中，以后新建用户时就会自动获取到这些环境和文件

#### /etc/login.defs

设置用户账号限制的文件，对 root 用户无效

/etc/shadow 配置优先级高于 /etc/login.defs

#### /etc/default/useradd

创建用户时的默认配置，useradd -D 修改的就是此文件



### 用户和组管理命令

useradd 和 adduser（adduser 是 useradd 的一个软链接）

newusers ：批量创建或修改已有用户信息。在创建用户时，它会读取 /etc/login.defs 文件中的配置项

groupadd ：创建一个新组

passwd ： 修改密码

chpasswd ：批量修改密码

chage ：修改或查看和密码时间相关的内容

userdel ： 删除用户和组

usermod ： 修改账户属性信息，待修改的用户必须没有在执行进程

vipw/vigr ：编辑用户和组文件的工具，vipw 可以修改 /etc/passwd 和 /etc/shadow ，vigr 可以修改 /etc/group  和 /etc/gshadow ，用这两个工具比较安全，在修改时会检查文件的一致性



### 其他用户相关命令

finger ：查看用户信息（centos 6 开始就没有该命令，需要安装）

id ：查看 UID ，GID 和所属组

users ：查看当前正在登陆的用户

last ：查看最近登陆的用户列表，实质查看文件 /var/log/wtmp

lastb ：查看谁尝试登陆但没登录成功，即能够审核和查看谁曾经不断的登录

who和w ：查看谁登录过，并做了什么，w 查看的信息比 who 多，w 第一行，分别表示当前时间，已开机时长，当前在线用户，过去1、5、15分钟的平均负载率

su 和 sudo ：su 切换用户，sudo 当前用户可以使用 root 权限（前提是当前用户要有 sudo 使用权限）

查看用户是否拥有 sudo 的执行权限，需要到 /etc/sudoers 下查看，该文件不能用 vi 直接编辑，必须 root 用户使用 visudo 命令编辑