### 基准测试的基本规则：

- 机器必须空闲，不要运行在共享硬件上，在长时间运行基准测试时不要进行其他操作
- 注意节电和热缩放 （主要是 CPU 受温度影响导致频率不稳定）
- 避免虚拟机和共享云托管（无法进行一致的测量）

基准测试接参数为：`*testing.B`

显式执行基准测试使用 `-bench` 标识，`-bench` 接收一个与待运行的基准测试名称相匹配的正则表达式，**go test 会在运行基准测试之前执行包里所有的单元测试，为了排除单元测试可以使用 `-run=^$`**

基准测试函数会被一直调用到 `b.N` 无效，`b.N` 从 1 开始，如果基准测试函数在 1 秒内就完成，则 `b.N` 增加，并再次运行基准测试函数。

基准测试名称的后缀 `-8` 表示与运行此次测试的 `GOMAXPROCS` 值有关，此数字默认为启动时 GO 进程可见的 CPU 数，可以使用 `-cpu` 改变此值，如 `-cpu=1,2,4` 可以传入多个值以列表形式运行基准测试。

`-benchtime` 标识增加运行时间，`-benchtime=10s` 

`-benchmem` 标识测试内存分配



在包目录内，所有以 `_test.go` 为后缀名的源文件并不是 go build 构建包的一部分，它们是 go test 测试的一部分。

在 `*_test.go` 文件中，有三种类型的函数：

- 测试函数：以 `Test` 为函数名前缀的函数，用于测试程序逻辑行为是否正确
- 基准测试函数：以 `Benchmark` 为函数名前缀的函数，它们用于衡量一些函数的性能；go test 会多次运行基准函数以计算一个平均的执行时间。
- 示例函数：以 `Example` 函数名为前缀的函数，提供一个有编译器保证正确性的实例文档。

### go test 参数：

- `-v`：打印每个测试函数的名字和运行时间
- `-run`：对应一个正则表达式，只有测试函数名正确匹配才会被 go test 测试命令运行