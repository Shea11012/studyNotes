##  表示 ip 地址

ipv4 地址长度 32 位采用点分十进制表示法，就是将 32 位的 ip 地址以每 8 位为一组，分为 4 组，每组以 `.` 隔开，再将每组转换为 10 进制。

ipv6 地址长度 128 位，以每 16 位作为一组，每组用冒号 `:` 分隔，使用十六进制表示。

ipv6 简化表示法：

- 一个块中前导的零不必书写
- 全零的块可以省略，并用 :: 代替。例如：`0:0:0:0:0:0:0:1` 可以简写为 `::1`。为避免歧义 ipv6 地址中的 :: 符号只能使用一次。
- ipv6 中嵌入 ipv4 地址可使用混合符号形式，紧接着 ipv4 部分的地址块值为 ffff，地址的其余部分使用点分四组格式。例如：`::ffff:10.0.0.1` 可表示 ipv4 地址 10.0.0.1。它被称为 ipv4 映射的 ipv6 地址。

### 分类寻址

ipv4 地址空间最初分为五大类，类由地址的头几位来定：

- 0 为 A 类，网络号为 7位，主机号为 24 位
- 10 为 B 类，网络号为 14 位，主机号为 16 位
- 110 为 C 类，网络号为 21 位，主机号为 8 位
- 1110 为 D 类
- 1111 为 E 类

最大主机个数：`2 ^ 主机号 - 2`

> 减 2 是因为 ip 地址中有两个主机号是特殊的，一个是全为 00000000  的一组，一个是全为 11111111 的一组
>
> 主机号全为 1 指定某个网络下的所有主机，用于广播
>
> 主机号全为 0 指定某个网络

**ipv4 地址空间划分**

| 类   | 地址范围                    | 高序位 | 用途 |
| ---- | --------------------------- | ------ | ---- |
| A    | 0.0.0.0 ~ 127.255.255.255   | 0      | 单播 |
| B    | 128.0.0.0 ~ 191.255.255.255 | 10     | 单播 |
| C    | 192.0.0.0 ~ 223.255.255.255 | 110    | 单播 |
| D    | 224.0.0.0 ~ 239.255.255.255 | 1110   | 多播 |
| E    | 240.0.0.0 ~ 255.255.255.255 | 1111   | 保留 |

#### 广播地址

广播地址用于在同一个链路中相互连接的主机之间发送数据包。

广播地址分为：

- 本地广播

> 如：网络地址为 192.168.0.0/24 的情况下，广播地址为 192.168.0.255，这个广播地址会被路由器屏蔽，不会到达 192.168.0.0/24 以外的其它链路上

- 直接广播

> 如：网络地址为 192.168.0.0/24 的主机向 192.168.1.255/24 的目标地址发送 ip 包。收到这个包的路由器，将数据转发给 192.168.1.0/24，从而使得所有 192.168.1.1 ~ 192.168.1.254 的主机都能收到这个包。（直接广播会有安全问题，多数情况下路由器上设置为不转发）

#### 多播地址

多播用于将包发送给特定组内的所有主机

D 类地址又可以划分为以下三类：

- 224.0.0.0 ~ 224.0.0.255 为预留的组播地址，只能在局域网中，路由器不会进行转发
- 224.0.1.0 ~ 238.255.255.255 为用户可用的组播地址，可以用于 Internet 上
- 239.0.0.0 ~ 239.255.255.255 为本地管理组播地址，可供内部网在内部使用，仅在特定的本地范围内有效

#### ip 分类的缺点：

- 同一网络下没有地址层次

> 如果一个公司用了 B 类地址，但是需要根据生产环境、测试环境、开发环境来划分地址层次，而这种 IP 分类是没有地址层次划分的功能，所以缺少地址的灵活性。

- A、B、C 类地址不能很好的与现实网络匹配

> C 类地址包含的最大主机数太少，只有 254 个
>
> B 类地址包含的最大主机数又太多



### 无分类地址 CIDR （子网掩码）

将 32 bit 的 ip 地址划分为两部分，前面是网络号，后面是主机号

具体表现形式：`a.b.c.d/x` ，`/x` 表示前 x 位属于网络号，x 的范围是 0 ~ 32 ，如：`10.100.122.2/24` ，`/24` 是网络号，剩余的 8 位是主机号



### ipv6

ipv6 地址主要有以下类型：

- 单播地址，用于一对一的通信
- 组播地址，用于一对多的通信
- 任播地址，用于通信最近的节点，最近的节点有路由协议决定

单播地址划分：

- 在同一链路单播通信，不经过路由器，可以使用链路本地单播地址
- 在内网里单播通信，可以使用唯一本地地址
- 在互联网通信，可以使用全局单播地址