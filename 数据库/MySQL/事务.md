### 数据库事务的四个特性ACID

原子性『Atomicity』：指这个操作要么全部成功，要么全部失败回滚

一致性『Consistency』：指数据库从一个一致性状态变换到另一个一致性状态，表示一个事务执行前后都必须处于一致性状态

隔离性『lsolation』：指当过个用户并发访问数据库时，数据库为每个用户开启事务，不被其他事务操作干扰，多个并发事务之间要相互隔离

持久性『Durability』：指一个事务一旦被提交了，那么对数据库中的数据改变就是永久性的。

### 并发操作的问题

**脏读**：指一个事务处理过程读取了另一个未提交事务中的数据

举例：

A 转账给 B 100元，并且还未提交成功，此时 B 用手机付款，这个事务读取到这个 100 元并进行了扣款，此时读取到的数据就是脏数据，因为 A 没有提交，可能会撤销

**不可重复读**：指对于某个数据，一个事务多次查询却返回了不同的数据值，这是由于查询间隔，被另一个事务修改并提交了。不可重复读一般是 update 操作

举例：

A 事务读取一个记录，然后 B 事务修改了这个记录并提交了，A 事务再进行读取时就会跟之前读取到的记录不一样

**幻读**：指事务非独立执行时发生的一种现象。

举例：

事务 A 对一个表中的所有行内的某一列执行了从 1 修改到 2 的操作，这时事 B又对这个表中插入了一行数据且这个数据项的数值还是为 1 并且提交给了数据库，而操作事务 A 的用户如果再查看刚才修改的数据，会发现还有一行没有修改。这行其实是事务 B 添加的，就好像产生幻觉，这就是幻读。幻读一般是 insert 操作

### 四种隔离

由低到高

#### Read uncommitted 未提交读

最低的隔离，可以读取到未提交的数据，会产生脏读

#### Read committed 提交读

一个事务要等另一个事务提交后才能读取数据

#### Repeatable read 重复读 MySQL 默认事务隔离级别

重复读，是在开始读取数据（事务开启时）不再允许修改操作

#### Serializable 序列化

Serializable 事务最高级别，在该级别下，事务串行化顺序执行，可以避免脏读、不可重复读与幻读。但是这个事务隔离级别效率低下，比较耗费数据库性能。

序列化就是将并行的操作，改成顺序执行





